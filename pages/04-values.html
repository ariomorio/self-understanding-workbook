<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¾¡å€¤è¦³ãƒ¯ãƒ¼ã‚¯ | ãƒã‚¤ã‚³ãƒ³ãƒ‘</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    .values-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 8px;
      max-height: 400px;
      overflow-y: auto;
      padding: var(--spacing-sm);
      background: var(--gray-light);
      border-radius: var(--radius-sm);
    }
    .value-tag {
      padding: 8px 12px;
      background: var(--white);
      border: 2px solid #e0e0e0;
      border-radius: 20px;
      font-size: 0.85rem;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
    }
    .value-tag:hover {
      border-color: var(--primary-orange);
    }
    .value-tag.selected {
      background: var(--primary-orange);
      border-color: var(--primary-orange);
      color: var(--white);
    }
    .category-title {
      background: var(--light-orange);
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-sm);
      font-weight: bold;
      margin: var(--spacing-md) 0 var(--spacing-sm);
      color: var(--primary-brown);
    }
    .selected-values {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      min-height: 50px;
      padding: var(--spacing-sm);
      background: var(--light-yellow);
      border-radius: var(--radius-sm);
      margin-top: var(--spacing-sm);
    }
    .selected-value {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 12px;
      background: var(--primary-orange);
      color: var(--white);
      border-radius: 20px;
      font-size: 0.9rem;
    }
    .selected-value .remove {
      cursor: pointer;
      opacity: 0.8;
    }
    .selected-value .remove:hover {
      opacity: 1;
    }
    .priority-list {
      counter-reset: priority;
    }
    .priority-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm);
      background: var(--white);
      border: 2px solid #e0e0e0;
      border-radius: var(--radius-sm);
      margin-bottom: var(--spacing-xs);
      cursor: grab;
      user-select: none;
      transition: transform 0.15s, box-shadow 0.15s;
    }
    .priority-item:active {
      cursor: grabbing;
    }
    .priority-item::before {
      counter-increment: priority;
      content: counter(priority);
      width: 28px;
      height: 28px;
      background: var(--primary-orange);
      color: var(--white);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }
    .priority-item.dragging {
      opacity: 0.5;
      transform: scale(1.02);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* Q9 ã‚¸ãƒ£ãƒ³ãƒ«åˆ†ã‘UI */
    .genre-pool {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      min-height: 50px;
      padding: var(--spacing-sm);
      background: var(--gray-light);
      border-radius: var(--radius-sm);
      border: 2px dashed #ccc;
    }
    .genre-pool-empty {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      color: var(--gray);
      font-size: 0.9rem;
    }
    .genre-block {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 8px 14px;
      background: var(--primary-orange);
      color: var(--white);
      border-radius: 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      user-select: none;
    }
    .genre-block:hover {
      filter: brightness(1.1);
      transform: translateY(-1px);
    }
    .genre-block:active {
      transform: scale(0.95);
    }
    .genre-shelf {
      margin-top: var(--spacing-md);
      border: 2px solid #e0e0e0;
      border-radius: var(--radius-md);
      overflow: hidden;
    }
    .genre-shelf-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--light-orange);
      font-weight: bold;
      color: var(--primary-brown);
    }
    .genre-shelf-header .delete-genre {
      background: none;
      border: none;
      color: #c62828;
      cursor: pointer;
      font-size: 0.85rem;
      padding: 4px 8px;
      border-radius: var(--radius-sm);
    }
    .genre-shelf-header .delete-genre:hover {
      background: rgba(198,40,40,0.1);
    }
    .genre-shelf-body {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      min-height: 44px;
      padding: var(--spacing-sm);
      background: var(--white);
      border-top: 1px solid #e0e0e0;
    }
    .genre-shelf-body.drag-over {
      background: #fff3e0;
      border-color: var(--primary-orange);
    }
    .genre-shelf-empty {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      color: #bbb;
      font-size: 0.85rem;
    }
    .add-genre-area {
      display: flex;
      gap: 8px;
      margin-top: var(--spacing-md);
    }
    .add-genre-area input {
      flex: 1;
      padding: var(--spacing-sm);
      border: 2px solid #e0e0e0;
      border-radius: var(--radius-sm);
      font-size: 1rem;
    }
    .add-genre-area input:focus {
      outline: none;
      border-color: var(--primary-orange);
    }
    .add-genre-btn {
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--primary-orange);
      color: var(--white);
      border: none;
      border-radius: var(--radius-sm);
      font-weight: bold;
      cursor: pointer;
      white-space: nowrap;
    }
    .add-genre-btn:hover {
      filter: brightness(1.1);
    }

    /* Q9 ã‚¿ãƒƒãƒ—æŒ¯ã‚Šåˆ†ã‘ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
    .genre-assign-menu {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--white);
      border-top: 2px solid var(--primary-orange);
      box-shadow: 0 -4px 16px rgba(0,0,0,0.15);
      padding: var(--spacing-md);
      z-index: 1000;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }
    .genre-assign-menu.show {
      transform: translateY(0);
    }
    .genre-assign-menu .menu-title {
      font-weight: bold;
      margin-bottom: var(--spacing-sm);
      color: var(--primary-brown);
    }
    .genre-assign-menu .menu-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .genre-assign-menu .menu-option {
      padding: 8px 16px;
      background: var(--light-orange);
      border: 2px solid var(--primary-orange);
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--primary-brown);
      font-weight: bold;
    }
    .genre-assign-menu .menu-option:hover {
      background: var(--primary-orange);
      color: var(--white);
    }
    .genre-assign-menu .menu-cancel {
      padding: 8px 16px;
      background: #eee;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9rem;
      color: #666;
    }
    .genre-assign-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.3);
      z-index: 999;
      display: none;
    }
    .genre-assign-overlay.show {
      display: block;
    }

    /* Q10 å„ªå…ˆé †ä½UI */
    .priority-item .handle {
      cursor: grab;
      font-size: 1.2rem;
      color: #999;
      padding: 0 4px;
    }
    .priority-item .handle:active {
      cursor: grabbing;
    }
    .priority-item .item-label {
      flex: 1;
      font-size: 1rem;
    }
    .priority-item .move-btns {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .priority-item .move-btn {
      background: none;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      padding: 2px 8px;
      font-size: 0.75rem;
      line-height: 1;
      color: #666;
    }
    .priority-item .move-btn:hover {
      background: var(--light-orange);
      border-color: var(--primary-orange);
    }
    .q10-empty-msg {
      text-align: center;
      color: var(--gray);
      padding: var(--spacing-md);
      font-size: 0.95rem;
    }
    .feedback-list {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }
    .feedback-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }
    .feedback-item .label {
      width: 30px;
      height: 30px;
      background: var(--primary-orange);
      color: var(--white);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }
    .feedback-item input {
      flex: 1;
      padding: var(--spacing-sm);
      border: 2px solid #e0e0e0;
      border-radius: var(--radius-sm);
      font-size: 1rem;
    }
    .feedback-item input:focus {
      outline: none;
      border-color: var(--primary-orange);
    }
  </style>
</head>
<body>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <header class="page-header">
    <h1><span class="icon">ğŸ’</span> è‡ªå·±ç†è§£ãƒ¯ãƒ¼ã‚¯â‘ ï¼šä¾¡å€¤è¦³</h1>
    <a href="https://drive.google.com/file/d/1Xlk49qzu269dSn6QymlWW8dCS2JJCD4e/view" target="_blank" class="video-link">
      è§£èª¬å‹•ç”»ã¯ã“ã¡ã‚‰
    </a>
  </header>

  <div class="container">
    <!-- Q1 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q1</span>
          å¹¼å°‘æœŸã‹ã‚‰ç¾åœ¨ã¾ã§ã§ã€Œæ¥½ã—ã‹ã£ãŸãƒ»å¤¢ä¸­ã ã£ãŸãƒ»æº€ãŸã•ã‚ŒãŸã€çµŒé¨“ã‚’ã§ãã‚‹é™ã‚Šæ›¸ãå‡ºãã†
        </div>
        <div class="question-hint">æº€ãŸã•ã‚ŒãŸã¨ãã«ã€ä½•ã‚’å¤§äº‹ã«ã—ã¦ã„ãŸã‹ã€‘ãŒä¾¡å€¤è¦³ã®ãƒ’ãƒ³ãƒˆï¼</div>
        <div class="question-example">äººã®è©±ã‚’èã„ã¦ã€Œã‚¹ãƒƒã‚­ãƒªã—ãŸï¼ã€ã¨è¨€ã‚ã‚ŒãŸæ™‚ãŒæº€ãŸã•ã‚ŒãŸ</div>
        <textarea id="q1" placeholder="æ€ã„å‡ºã›ã‚‹é™ã‚Šæ›¸ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†..."></textarea>
      </div>
    </div>

    <!-- Q2 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q2</span>
          ä»Šã¾ã§ã®äººç”Ÿã§ç‰¹ã«å°è±¡ã«æ®‹ã£ã¦ã„ã‚‹ã€Œã‚¤ãƒ©ã£ã¨ã—ãŸã“ã¨ã€ã‚’æ›¸ãå‡ºã—ã¦ãã ã•ã„ï¼
        </div>
        <div class="question-hint">æ€’ã‚Šãƒ»é•å’Œæ„Ÿã«ã¯ã€å®ˆã‚ŠãŸã„ä¾¡å€¤è¦³ã€‘ãŒéš ã‚Œã¦ã„ã‚‹ï¼</div>
        <div class="question-example">å¤–æ³¨å…ˆã®å¹´é…ã®ã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¹³ä¸æº€ã‚’è¨€ã„ãªãŒã‚‰ä»•äº‹ã—ã¦ã„ã¦ã€æ°—åˆ†æ‚ªã‹ã£ãŸ</div>
        <textarea id="q2" placeholder="ã‚¤ãƒ©ã£ã¨ã—ãŸä½“é¨“ã‚’æ›¸ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†..."></textarea>
      </div>
    </div>

    <!-- Q3 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q3</span>
          ä»Šã®ä»•äº‹ã‚’ã‚„ã‚ã‚‹ã¨ã—ãŸã‚‰ã©ã†æ€ã„ã¾ã™ã‹ï¼Ÿ
        </div>
        <div class="question-hint">ä»•äº‹ã®ä¸­ã«ã€ä½¿å‘½æ„Ÿï¼å¤§äº‹ã«ã—ã¦ã„ã‚‹æ„Ÿè¦šã€‘ãŒè¦‹ãˆã‚‹</div>
        <div class="question-example">ã‚‚ã£ã¨ãŸãã•ã‚“ã®äººã‚’åŠ©ã‘ã¦ã‚ã’ãŸã„ï¼ä»Šè¾ã‚ãŸã‚‰ã€æ‚©ã¿ãŒè§£æ±ºã§ããªã„äººãŒãŸãã•ã‚“ã„ã¦å¿ƒé…</div>
        <textarea id="q3" placeholder="æ­£ç›´ãªæ°—æŒã¡ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†..."></textarea>
      </div>
    </div>

    <!-- Q4 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q4</span>
          éå»ã®å°è±¡ã«æ®‹ã£ã¦ã„ã‚‹å‡ºæ¥äº‹ã‚’ã§ãã‚‹ã ã‘ãŸãã•ã‚“ã‚ã’ã¦ãã ã•ã„ï¼
        </div>
        <div class="question-hint">éå»ã‚’é€šã—ã¦ã€Œä¸€è²«ã—ã¦å¤§äº‹ã«ã—ã¦ããŸä¾¡å€¤è¦³ã€ãŒè¦‹ãˆã¦ãã‚‹ï¼</div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">å¹¼ç¨šåœ’ãƒ»ä¿è‚²åœ’</label>
          <textarea id="q4-1" placeholder="ä¾‹ï¼‰è‡ªåˆ†ã®ã‚¯ãƒ©ã‚¹ã®æ‹…ä»»ã‚ˆã‚Šä»–ã®ã‚¯ãƒ©ã‚¹ã®å…ˆç”ŸãŒå¥½ãã ã£ãŸ"></textarea>
        </div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">å°å­¦ç”Ÿ</label>
          <textarea id="q4-2" placeholder="ä¾‹ï¼‰æ¯æ—¥å­¦æ ¡çµ‚ã‚ã‚Šã«ã¿ã‚“ãªã§å…¬åœ’ã§éŠã¶ã®ãŒå¥½ãã ã£ãŸ"></textarea>
        </div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">ä¸­å­¦æ ¡</label>
          <textarea id="q4-3" placeholder="ä¾‹ï¼‰å¼•ã£è¶Šã—ãŸå­¦æ ¡ã§å¥³ã®å­ã¨ä»²è‰¯ãè©±ã—ã¦ãŸã‚‰ã€ã‹ã‚‰ã‹ã‚ã‚Œã¦å¹¼ç¨šãªäººãŸã¡ã ãªã¨æ€ã£ãŸ"></textarea>
        </div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">é«˜æ ¡</label>
          <textarea id="q4-4" placeholder="ä¾‹ï¼‰ãƒãƒ³ãƒ‰ã‚’çµ„ã‚“ã§æ–‡åŒ–ç¥­ã§åˆã‚ã¦ãƒ©ã‚¤ãƒ–ã—ãŸæ™‚ã®è¡æ’ƒã¨é«˜æšæ„ŸãŒæœ€é«˜ã ã£ãŸ"></textarea>
        </div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">å¤§å­¦ãƒ»çŸ­å¤§ãƒ»å°‚é–€</label>
          <textarea id="q4-5" placeholder="ä¾‹ï¼‰ãƒãƒ³ãƒ‰æ´»å‹•ã°ã‹ã‚Šã—ã¦ã„ã¦ã€å¤§å­¦ã«è¡Œã‹ãªããªã‚Šãƒã‚¤ãƒˆã°ã‹ã‚Šã—ã¦ã„ãŸ"></textarea>
        </div>
      </div>
    </div>

    <!-- Q6 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q6</span>
          å°Šæ•¬ã™ã‚‹äººã‚’1äººã‚ã’ã¦ãã ã•ã„
        </div>
        <div class="question-hint">ã€Œè‡ªåˆ†ãŒæ±‚ã‚ã¦ã„ã‚‹ãƒ»ãªã‚ŠãŸã„å§¿ã€ï¼ä¾¡å€¤è¦³ã®ç¾ã‚Œï¼</div>
        <p style="font-size: 0.9rem; color: var(--text-light); margin-bottom: var(--spacing-sm);">
          ï¼ˆèº«è¿‘ãªäººã€èŠ¸èƒ½äººã€æ­´å²ä¸Šã®äººç‰©ã€ãƒ‰ãƒ©ãƒã®ç™»å ´äººç‰©ã€æ¼«ç”»ã‚„ã‚²ãƒ¼ãƒ ã®ç™»å ´äººç‰©ãªã© èª°ã§ã‚‚OKï¼‰
        </p>
        <textarea id="q6-1" placeholder="å°Šæ•¬ã™ã‚‹äººã®åå‰..." style="min-height: 60px;"></textarea>

        <div style="margin-top: var(--spacing-sm);">
          <label style="font-weight: bold; color: var(--primary-brown);">ãã®äººã®ã©ã‚“ãªã¨ã“ã‚ãŒå°Šæ•¬ã§ãã¾ã™ã‹ï¼Ÿ</label>
          <textarea id="q6-2" placeholder="ä¾‹ï¼‰äººã‚’ã¾ã¨ã‚ã‚‹ã®ãŒä¸Šæ‰‹â†’ãƒªãƒ¼ãƒ€ãƒ¼"></textarea>
        </div>
      </div>
    </div>

    <!-- Q7 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q7</span>
          èº«ã®å›ã‚Šã«ã„ã‚‹5äººä»¥ä¸Šã‹ã‚‰ã€è‡ªåˆ†ã¯ã©ã‚“ãªã“ã¨ã«ä¾¡å€¤ã‚’æ„Ÿã˜ã¦ã„ã‚‹äººã«è¦‹ãˆã¦ã„ã‚‹ã‹ã€‘ã‚’èãå‡ºã—ã¦ãã ã•ã„
        </div>
        <div class="question-hint">è‡ªå·±èªè­˜ã¨ä»–è€…èªè­˜ã‚’ç…§ã‚‰ã—åˆã‚ã›ã¦ã€ä¾¡å€¤è¦³ã®ç¢ºä¿¡åº¦ã‚’é«˜ã‚ã‚‹ï¼</div>
        <p style="font-size: 0.9rem; color: var(--text-light); margin-bottom: var(--spacing-sm);">
          å®¶æ—ã€å‹é”ã€è·å ´ã®äººã€ç™ºä¿¡è€…ä»²é–“ãªã© ã„ã‚ã‚“ãªã‚¸ãƒ£ãƒ³ãƒ«ã®äººã‹ã‚‰èã„ã¦ãã ã•ã„
        </p>

        <div class="feedback-list">
          <div class="feedback-item">
            <div class="label">1</div>
            <input type="text" id="q7-1" placeholder="ä¾‹ï¼‰å¥¥ã•ã‚“â†’ä»•äº‹ã‚’é€šã—ã¦å¾—ã‚‰ã‚Œã‚‹çµŒé¨“">
          </div>
          <div class="feedback-item">
            <div class="label">2</div>
            <input type="text" id="q7-2" placeholder="èª°ã‹ã‚‰ï¼Ÿâ†’ä½•ã¨è¨€ã‚ã‚ŒãŸï¼Ÿ">
          </div>
          <div class="feedback-item">
            <div class="label">3</div>
            <input type="text" id="q7-3" placeholder="èª°ã‹ã‚‰ï¼Ÿâ†’ä½•ã¨è¨€ã‚ã‚ŒãŸï¼Ÿ">
          </div>
          <div class="feedback-item">
            <div class="label">4</div>
            <input type="text" id="q7-4" placeholder="èª°ã‹ã‚‰ï¼Ÿâ†’ä½•ã¨è¨€ã‚ã‚ŒãŸï¼Ÿ">
          </div>
          <div class="feedback-item">
            <div class="label">5</div>
            <input type="text" id="q7-5" placeholder="èª°ã‹ã‚‰ï¼Ÿâ†’ä½•ã¨è¨€ã‚ã‚ŒãŸï¼Ÿ">
          </div>
        </div>
      </div>
    </div>

    <!-- Q8 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q8</span>
          Q1ã€œ7ã‚’è¦‹è¿”ã—ã¦ã€ã©ã‚“ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆä¾¡å€¤è¦³ï¼‰ãŒå…±é€šã—ã¦ã¾ã™ã‹ï¼Ÿ
        </div>
        <div class="question-hint">ä¸‹ã®ãƒªã‚¹ãƒˆã‹ã‚‰é¸ã‚“ã§ãã ã•ã„ï¼ˆã“ã‚Œä»¥å¤–ã«æ€ã„ã¤ã„ãŸä¾¡å€¤è¦³ã§ã‚‚OKï¼‰</div>

        <p style="margin: var(--spacing-sm) 0; font-weight: bold;">é¸ã‚“ã ä¾¡å€¤è¦³ï¼š</p>
        <div class="selected-values" id="selectedValues">
          <span style="color: var(--gray);">ä¸‹ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„</span>
        </div>

        <div class="category-title">äººé–“é–¢ä¿‚ãƒ»ã¤ãªãŒã‚Š</div>
        <div class="values-grid" id="values-relationship"></div>

        <div class="category-title">æˆé•·ãƒ»å­¦ã³</div>
        <div class="values-grid" id="values-growth"></div>

        <div class="category-title">æƒ…ç†±ãƒ»é”æˆ</div>
        <div class="values-grid" id="values-passion"></div>

        <div class="category-title">å®‰å¿ƒãƒ»å®‰å®š</div>
        <div class="values-grid" id="values-stability"></div>

        <div class="category-title">è¡¨ç¾ãƒ»ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</div>
        <div class="values-grid" id="values-creative"></div>

        <div class="category-title">è‡ªç«‹ãƒ»ãƒã‚¤ãƒ³ãƒ‰</div>
        <div class="values-grid" id="values-independence"></div>

        <div class="category-title">ä»•äº‹ãƒ»ã‚¹ã‚­ãƒ«ãƒ»å½±éŸ¿åŠ›</div>
        <div class="values-grid" id="values-work"></div>

        <div class="category-title">è²¢çŒ®ãƒ»ç¤¾ä¼šæ€§</div>
        <div class="values-grid" id="values-contribution"></div>

        <div class="category-title">ç’°å¢ƒãƒ»ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«</div>
        <div class="values-grid" id="values-lifestyle"></div>

        <div class="category-title">ç†å¿µãƒ»ä¿¡æ¡ãƒ»ä¸–ç•Œè¦³</div>
        <div class="values-grid" id="values-philosophy"></div>

        <div style="margin-top: var(--spacing-md);">
          <label style="font-weight: bold; color: var(--primary-brown);">ãã®ä»–ã®ä¾¡å€¤è¦³ï¼ˆè‡ªç”±è¨˜å…¥ï¼‰</label>
          <input type="text" id="q8-other" placeholder="ãƒªã‚¹ãƒˆã«ãªã„ä¾¡å€¤è¦³ãŒã‚ã‚Œã°å…¥åŠ›" style="width: 100%; padding: var(--spacing-sm); border: 2px solid #e0e0e0; border-radius: var(--radius-sm);">
        </div>
      </div>
    </div>

    <!-- Q9 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q9</span>
          Q8ã§å‡ºã¦ããŸãƒ¯ãƒ¼ãƒ‰ã‚’5ã¤ä»¥ä¸Šã®ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã«åˆ†ã‘ã¦ã¿ã‚ˆã†
        </div>
        <div class="question-hint">ã‚¸ãƒ£ãƒ³ãƒ«åŒ–ã™ã‚‹ã¨ã€è‡ªåˆ†ã®è¡Œå‹•ãƒ»ä»•äº‹ãƒ»é¸æŠã¨çµã³ã¤ã‘ã‚„ã™ããªã‚‹ï¼</div>
        <p style="font-size: 0.9rem; color: var(--text-light); margin-bottom: var(--spacing-sm);">
          æœ¬æ£šã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã¦ã­ã€‚ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã‚¸ãƒ£ãƒ³ãƒ«ï¼ˆæ£šï¼‰ã«æŒ¯ã‚Šåˆ†ã‘ã‚ˆã†ï¼
        </p>

        <p style="font-weight: bold; color: var(--primary-brown); margin-bottom: var(--spacing-xs);">æœªåˆ†é¡ã®ä¾¡å€¤è¦³</p>
        <div class="genre-pool" id="genrePool">
          <span class="genre-pool-empty">Q8ã§ä¾¡å€¤è¦³ã‚’é¸ã‚“ã§ãã ã•ã„</span>
        </div>

        <div class="add-genre-area">
          <input type="text" id="newGenreName" placeholder="ã‚¸ãƒ£ãƒ³ãƒ«åã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šäººé–“é–¢ä¿‚ï¼‰">
          <button class="add-genre-btn" onclick="addGenre()">+ è¿½åŠ </button>
        </div>

        <div id="genreShelves"></div>
      </div>
    </div>

    <!-- Q9 ã‚¿ãƒƒãƒ—æŒ¯ã‚Šåˆ†ã‘ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div class="genre-assign-overlay" id="genreOverlay" onclick="closeAssignMenu()"></div>
    <div class="genre-assign-menu" id="genreAssignMenu">
      <div class="menu-title" id="assignMenuTitle">ã€Œã€ã‚’ã©ã®ã‚¸ãƒ£ãƒ³ãƒ«ã«å…¥ã‚Œã‚‹ï¼Ÿ</div>
      <div class="menu-options" id="assignMenuOptions"></div>
    </div>

    <!-- Q10 -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">Q10</span>
          5ã¤ä»¥ä¸Šã®ã‚¸ãƒ£ãƒ³ãƒ«åˆ†ã‘ã§ããŸã‚‰ã€å„ªå…ˆé †ä½ã‚’ã¤ã‘ã¦ã¿ã‚ˆã†
        </div>
        <div class="question-hint">ã“ã®å„ªå…ˆé †ä½ãŒ"åˆ¤æ–­è»¸"ã«ãªã‚‹ï¼ãƒ‰ãƒ©ãƒƒã‚°ã¾ãŸã¯â–²â–¼ãƒœã‚¿ãƒ³ã§ä¸¦ã¹æ›¿ãˆã‚ˆã†</div>
        <div class="priority-list" id="q10PriorityList">
          <div class="q10-empty-msg">Q9ã§ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã¨ã€ã“ã“ã«è‡ªå‹•ã§è¡¨ç¤ºã•ã‚Œã¾ã™</div>
        </div>
      </div>
    </div>

    <!-- ã¾ã¨ã‚ -->
    <div class="section">
      <div class="question-card">
        <div class="question-text">
          <span class="question-number">ğŸ“</span>
          è‡ªåˆ†ã®ä¾¡å€¤è¦³ã®èª¬æ˜æ›¸ã‚’ä½œã£ã¦ã¿ã‚ˆã†
        </div>
        <textarea id="summary" placeholder="ä¾‹ï¼‰ç§ã¯â—¯â—¯ãŒãªã„ã¨ä¸å®‰ã«ãªã‚‹ã€€ç§ã¯â—¯â—¯ãŒã‚ã‚‹ã¨æº€ãŸã•ã‚Œã‚‹ã€€ç§ã¯ã€‡ã€‡ãªäººã¨ä¸€ç·’ã«ã„ã‚‹ã¨å®‰å¿ƒã™ã‚‹ã€€ç§ã¯ã€‡ã€‡ã‚’å¤§åˆ‡ã«ã§ãã‚‹ä»•äº‹ãŒã—ãŸã„" style="min-height: 150px;"></textarea>
      </div>

      <div style="background: var(--light-green); padding: var(--spacing-md); border-radius: var(--radius-md); margin-top: var(--spacing-md);">
        <p style="text-align: center; font-size: 1.1rem; color: #2e7d32;">
          <strong>ãƒ¯ãƒ¼ã‚¯ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼</strong>
        </p>
        <p style="text-align: center; margin-top: var(--spacing-sm);">
          ã‚ãªãŸãŒå¤§åˆ‡ã«ã—ã¦ã„ã‚‹ä¾¡å€¤è¦³ã¯ã€ã“ã‚Œã¾ã§ã®äººç”Ÿã‚’é€šã—ã¦ã‚ãªãŸè‡ªèº«ãŒé¸ã³å–ã£ã¦ããŸ"ä¿¡å¿µã®ã‚¿ãƒ"ã§ã™ã€‚<br>
          ã‚ãªãŸã®ä¾¡å€¤è¦³ã¯ã€è¿·ã£ãŸã¨ãã«ç«‹ã¡è¿”ã‚Œã‚‹ã€å¿ƒã®ã‚³ãƒ³ãƒ‘ã‚¹ã€‘ã«ãªã£ã¦ãã‚Œã¾ã™ã€‚
        </p>
      </div>
    </div>
  </div>

  <nav class="nav-bottom">
    <a href="03-personality.html" class="btn btn-secondary">â† å‰ã¸</a>
    <a href="../index.html" class="btn btn-secondary" style="font-size:0.85rem;">ç›®æ¬¡</a>
    <button class="btn btn-save" onclick="saveData()">ä¿å­˜ã™ã‚‹</button>
    <a href="05-talent.html" class="btn btn-primary">æ¬¡ã¸ â†’</a>
  </nav>

  <div class="toast" id="toast"></div>

  <!-- Lark APIé€£æº -->
  <script src="../js/lark-api.js"></script>
  <script src="../js/lark-config.js"></script>
  <script src="../js/data-sync.js"></script>

  <script>
    // ä¾¡å€¤è¦³ãƒªã‚¹ãƒˆ
    const valuesData = {
      relationship: ["ä¿¡é ¼", "èª å®Ÿ", "å„ªã—ã•", "æ€ã„ã‚„ã‚Š", "å”åŠ›", "å…±æ„Ÿ", "å®¶æ—", "ä»²é–“", "çµ†", "å°Šé‡"],
      growth: ["å‘ä¸Šå¿ƒ", "æ¢ç©¶å¿ƒ", "å¥½å¥‡å¿ƒ", "è‡ªå·±æˆé•·", "æˆæœ", "åŠªåŠ›", "å­¦ã³ç¶šã‘ã‚‹", "è³‡æ ¼ãƒ»çŸ¥è­˜", "æˆç†Ÿ", "ä¸Šé”"],
      passion: ["é”æˆæ„Ÿ", "æŒ‘æˆ¦", "ã‚„ã‚Šãã‚‹", "æƒ…ç†±", "å¤¢ä¸­", "é‡å¿ƒ", "ç¶™ç¶š", "ç«¶äº‰", "å‹åˆ©", "é«˜ã¿ã‚’ç›®æŒ‡ã™"],
      stability: ["å®‰å®š", "å®‰å¿ƒæ„Ÿ", "å¹³ç©", "å¥åº·", "ç¶™ç¶šæ€§", "ç¢ºå®Ÿæ€§", "è²¯é‡‘", "ç¿’æ…£", "è¦å‰‡æ­£ã—ã•", "ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒãƒƒãƒˆ"],
      creative: ["è‡ªç”±", "è‡ªå·±è¡¨ç¾", "èŠ¸è¡“", "ç¾æ„è­˜", "ç™ºä¿¡", "æ›¸ãã“ã¨", "è©±ã™ã“ã¨", "ã‚»ãƒ³ã‚¹", "æ„Ÿæ€§", "ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–"],
      independence: ["è‡ªç”±æ„å¿—", "ä¸»ä½“æ€§", "è‡ªç«‹", "è‡ªä¿¡", "æœ¬éŸ³ã§ç”Ÿãã‚‹", "ç´ ç›´ã•", "è¦šæ‚Ÿ", "è‡ªå·±å—å®¹", "è‡ªå·±è²¬ä»»", "é¸æŠã®è‡ªç”±"],
      work: ["ãƒ—ãƒ­æ„è­˜", "å°‚é–€æ€§", "ç”Ÿç”£æ€§", "å®Ÿè¡ŒåŠ›", "è¡Œå‹•åŠ›", "åˆ†æåŠ›", "æ±ºæ–­åŠ›", "ä¿¡å¿µ", "çµæœä¸»ç¾©", "å½±éŸ¿åŠ›"],
      contribution: ["äººã®å½¹ã«ç«‹ã¤", "ç¤¾ä¼šè²¢çŒ®", "æ•™ãˆã‚‹", "è‚²ã¦ã‚‹", "æ”¯æ´", "æ„Ÿè¬ã•ã‚Œã‚‹", "èª°ã‹ã®ãŸã‚ã«", "ä¸ãˆã‚‹", "ã¤ãªã’ã‚‹", "å¥‰ä»•"],
      lifestyle: ["è‡ªç„¶ã¨ã®å…±ç”Ÿ", "ã‚ªãƒ¼ã‚¬ãƒ‹ãƒƒã‚¯", "ã‚·ãƒ³ãƒ—ãƒ«ãƒ©ã‚¤ãƒ•", "ã‚¹ãƒ­ãƒ¼ãƒ©ã‚¤ãƒ•", "åœ°å…ƒæ„›", "ã‚°ãƒ­ãƒ¼ãƒãƒ«è¦–ç‚¹", "ãƒŸãƒ‹ãƒãƒªã‚ºãƒ ", "ã‚µã‚¹ãƒ†ãƒŠãƒ–ãƒ«", "æ™‚é–“ã®ä½™ç™½", "ç©ºé–“ç¾"],
      philosophy: ["æ­£ç¾©", "å…¬å¹³", "å¤šæ§˜æ€§", "ä¿¡ä»°ãƒ»ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«", "å“²å­¦", "ä¸€è²«æ€§", "ä¿¡å¿µã‚’æ›²ã’ãªã„", "æœ¬è³ªå¿—å‘", "ç†æƒ³è¿½æ±‚", "ä¸–ç•Œã‚’å¤‰ãˆã‚‹"]
    };

    let selectedValues = [];

    // === Q9 ã‚¸ãƒ£ãƒ³ãƒ«åˆ†ã‘ãƒ‡ãƒ¼ã‚¿ ===
    // { "äººé–“é–¢ä¿‚": ["ä¿¡é ¼", "èª å®Ÿ"], "è‡ªå·±æˆé•·": ["æŒ‘æˆ¦"] }
    let genreData = {};
    let pendingAssignValue = null; // ã‚¿ãƒƒãƒ—æŒ¯ã‚Šåˆ†ã‘ä¸­ã®å€¤

    // === Q10 å„ªå…ˆé †ä½ãƒ‡ãƒ¼ã‚¿ ===
    // ["äººé–“é–¢ä¿‚", "è‡ªå·±æˆé•·", ...]
    let priorityOrder = [];

    // ä¾¡å€¤è¦³ã‚¿ã‚°ã‚’ç”Ÿæˆ
    function renderValueTags() {
      Object.keys(valuesData).forEach(category => {
        const container = document.getElementById(`values-${category}`);
        if (container) {
          valuesData[category].forEach(value => {
            const tag = document.createElement('div');
            tag.className = 'value-tag';
            tag.textContent = value;
            tag.onclick = () => toggleValue(value, tag);
            container.appendChild(tag);
          });
        }
      });
    }

    // ä¾¡å€¤è¦³ã®é¸æŠ/è§£é™¤
    function toggleValue(value, tagEl) {
      const index = selectedValues.indexOf(value);
      if (index === -1) {
        selectedValues.push(value);
        tagEl.classList.add('selected');
      } else {
        selectedValues.splice(index, 1);
        tagEl.classList.remove('selected');
        // Q9ã‹ã‚‰è©²å½“ãƒ–ãƒ­ãƒƒã‚¯ã‚‚å‰Šé™¤
        removeValueFromAllGenres(value);
      }
      updateSelectedDisplay();
      renderQ9();
    }

    // é¸æŠã•ã‚ŒãŸä¾¡å€¤è¦³ã‚’è¡¨ç¤º
    function updateSelectedDisplay() {
      const container = document.getElementById('selectedValues');
      if (selectedValues.length === 0) {
        container.innerHTML = '<span style="color: var(--gray);">ä¸‹ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„</span>';
      } else {
        container.innerHTML = selectedValues.map(v =>
          `<span class="selected-value">${v}<span class="remove" onclick="removeValue('${v}')">Ã—</span></span>`
        ).join('');
      }
      updateProgress();
    }

    // ä¾¡å€¤è¦³ã‚’å‰Šé™¤
    function removeValue(value) {
      const index = selectedValues.indexOf(value);
      if (index !== -1) {
        selectedValues.splice(index, 1);
        document.querySelectorAll('.value-tag').forEach(tag => {
          if (tag.textContent === value) tag.classList.remove('selected');
        });
        // Q9ã‹ã‚‰è©²å½“ãƒ–ãƒ­ãƒƒã‚¯ã‚‚å‰Šé™¤
        removeValueFromAllGenres(value);
        updateSelectedDisplay();
        renderQ9();
      }
    }

    // === Q9 ã‚¸ãƒ£ãƒ³ãƒ«åˆ†ã‘UI ===

    // Q9: å…¨ã‚¸ãƒ£ãƒ³ãƒ«ã‹ã‚‰ç‰¹å®šã®å€¤ã‚’å‰Šé™¤
    function removeValueFromAllGenres(value) {
      Object.keys(genreData).forEach(genre => {
        const idx = genreData[genre].indexOf(value);
        if (idx !== -1) genreData[genre].splice(idx, 1);
      });
    }

    // Q9: æœªåˆ†é¡ï¼ˆã©ã®ã‚¸ãƒ£ãƒ³ãƒ«ã«ã‚‚å±ã—ã¦ã„ãªã„ï¼‰ã®å€¤ã‚’å–å¾—
    function getUnassignedValues() {
      const assigned = new Set();
      Object.values(genreData).forEach(values => {
        values.forEach(v => assigned.add(v));
      });
      return selectedValues.filter(v => !assigned.has(v));
    }

    // Q9: ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ 
    function addGenre() {
      const input = document.getElementById('newGenreName');
      const name = input.value.trim();
      if (!name) return;
      if (genreData[name] !== undefined) {
        showToast('åŒã˜åå‰ã®ã‚¸ãƒ£ãƒ³ãƒ«ãŒã‚ã‚Šã¾ã™', 'error');
        return;
      }
      genreData[name] = [];
      input.value = '';
      renderQ9();
      renderQ10();
    }

    // Q9: ã‚¸ãƒ£ãƒ³ãƒ«ã‚’å‰Šé™¤ï¼ˆä¸­ã®ãƒ–ãƒ­ãƒƒã‚¯ã¯æœªåˆ†é¡ã«æˆ»ã™ï¼‰
    function removeGenre(name) {
      delete genreData[name];
      // Q10ã®å„ªå…ˆé †ä½ã‹ã‚‰ã‚‚å‰Šé™¤
      priorityOrder = priorityOrder.filter(g => g !== name);
      renderQ9();
      renderQ10();
    }

    // Q9: ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¸ãƒ£ãƒ³ãƒ«ã«æŒ¯ã‚Šåˆ†ã‘
    function assignToGenre(value, genre) {
      // ã¾ãšä»–ã®ã‚¸ãƒ£ãƒ³ãƒ«ã‹ã‚‰å‰Šé™¤
      removeValueFromAllGenres(value);
      // æŒ‡å®šã‚¸ãƒ£ãƒ³ãƒ«ã«è¿½åŠ 
      if (!genreData[genre]) genreData[genre] = [];
      if (!genreData[genre].includes(value)) {
        genreData[genre].push(value);
      }
      renderQ9();
    }

    // Q9: ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¸ãƒ£ãƒ³ãƒ«ã‹ã‚‰å¤–ã™ï¼ˆæœªåˆ†é¡ã«æˆ»ã™ï¼‰
    function unassignFromGenre(value) {
      removeValueFromAllGenres(value);
      renderQ9();
    }

    // Q9: ã‚¿ãƒƒãƒ—æŒ¯ã‚Šåˆ†ã‘ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
    function openAssignMenu(value) {
      pendingAssignValue = value;
      const genres = Object.keys(genreData);
      if (genres.length === 0) {
        showToast('å…ˆã«ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ ã—ã¦ãã ã•ã„', 'warning');
        return;
      }
      document.getElementById('assignMenuTitle').textContent = `ã€Œ${value}ã€ã‚’ã©ã®ã‚¸ãƒ£ãƒ³ãƒ«ã«å…¥ã‚Œã‚‹ï¼Ÿ`;
      const optionsEl = document.getElementById('assignMenuOptions');
      optionsEl.innerHTML = genres.map(g =>
        `<div class="menu-option" onclick="doAssign('${g.replace(/'/g, "\\'")}')">${g}</div>`
      ).join('') + '<button class="menu-cancel" onclick="closeAssignMenu()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>';

      document.getElementById('genreOverlay').classList.add('show');
      document.getElementById('genreAssignMenu').classList.add('show');
    }

    // Q9: æŒ¯ã‚Šåˆ†ã‘å®Ÿè¡Œ
    function doAssign(genre) {
      if (pendingAssignValue) {
        assignToGenre(pendingAssignValue, genre);
        pendingAssignValue = null;
      }
      closeAssignMenu();
    }

    // Q9: æŒ¯ã‚Šåˆ†ã‘ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹
    function closeAssignMenu() {
      pendingAssignValue = null;
      document.getElementById('genreOverlay').classList.remove('show');
      document.getElementById('genreAssignMenu').classList.remove('show');
    }

    // Q9: UIå…¨ä½“ã‚’å†æç”»
    function renderQ9() {
      // æœªåˆ†é¡ã‚¨ãƒªã‚¢
      const pool = document.getElementById('genrePool');
      const unassigned = getUnassignedValues();
      if (unassigned.length === 0 && selectedValues.length === 0) {
        pool.innerHTML = '<span class="genre-pool-empty">Q8ã§ä¾¡å€¤è¦³ã‚’é¸ã‚“ã§ãã ã•ã„</span>';
      } else if (unassigned.length === 0) {
        pool.innerHTML = '<span class="genre-pool-empty">ã™ã¹ã¦æŒ¯ã‚Šåˆ†ã‘æ¸ˆã¿!</span>';
      } else {
        pool.innerHTML = unassigned.map(v =>
          `<div class="genre-block" onclick="openAssignMenu('${v.replace(/'/g, "\\'")}')" draggable="true" data-value="${v}">${v}</div>`
        ).join('');
      }

      // ã‚¸ãƒ£ãƒ³ãƒ«æ£š
      const shelves = document.getElementById('genreShelves');
      shelves.innerHTML = Object.keys(genreData).map(genre => {
        const values = genreData[genre].filter(v => selectedValues.includes(v));
        // genreDataã®ä¸­ã‹ã‚‰selectedValuesã«å«ã¾ã‚Œãªã„ã‚‚ã®ã‚’è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        genreData[genre] = values;
        const blocksHtml = values.length > 0
          ? values.map(v =>
              `<div class="genre-block" onclick="unassignFromGenre('${v.replace(/'/g, "\\'")}')" title="ã‚¯ãƒªãƒƒã‚¯ã§æœªåˆ†é¡ã«æˆ»ã™">${v}</div>`
            ).join('')
          : '<span class="genre-shelf-empty">ã“ã“ã«ãƒ–ãƒ­ãƒƒã‚¯ã‚’æŒ¯ã‚Šåˆ†ã‘ã‚ˆã†</span>';

        return `<div class="genre-shelf">
          <div class="genre-shelf-header">
            <span>ğŸ“š ${genre}</span>
            <button class="delete-genre" onclick="removeGenre('${genre.replace(/'/g, "\\'")}')">Ã—å‰Šé™¤</button>
          </div>
          <div class="genre-shelf-body" data-genre="${genre}">${blocksHtml}</div>
        </div>`;
      }).join('');

      // Enter key ã§ã‚¸ãƒ£ãƒ³ãƒ«è¿½åŠ 
      const input = document.getElementById('newGenreName');
      input.onkeydown = (e) => { if (e.key === 'Enter') { e.preventDefault(); addGenre(); } };

      updateProgress();
    }

    // === Q10 å„ªå…ˆé †ä½UI ===

    // Q10: ã‚¸ãƒ£ãƒ³ãƒ«ä¸€è¦§ã‹ã‚‰ãƒªã‚¹ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ
    function renderQ10() {
      const genres = Object.keys(genreData);
      const list = document.getElementById('q10PriorityList');

      if (genres.length === 0) {
        list.innerHTML = '<div class="q10-empty-msg">Q9ã§ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã¨ã€ã“ã“ã«è‡ªå‹•ã§è¡¨ç¤ºã•ã‚Œã¾ã™</div>';
        priorityOrder = [];
        return;
      }

      // priorityOrderã«æ–°ã—ã„ã‚¸ãƒ£ãƒ³ãƒ«ã‚’è¿½åŠ ã€å‰Šé™¤ã•ã‚ŒãŸã‚¸ãƒ£ãƒ³ãƒ«ã‚’é™¤å¤–
      const genreSet = new Set(genres);
      priorityOrder = priorityOrder.filter(g => genreSet.has(g));
      genres.forEach(g => {
        if (!priorityOrder.includes(g)) priorityOrder.push(g);
      });

      list.innerHTML = priorityOrder.map((genre, idx) =>
        `<div class="priority-item" draggable="true" data-index="${idx}">
          <span class="handle" title="ãƒ‰ãƒ©ãƒƒã‚°ã§ä¸¦ã¹æ›¿ãˆ">â‰¡</span>
          <span class="item-label">ğŸ“š ${genre}</span>
          <div class="move-btns">
            <button class="move-btn" onclick="moveItem(${idx}, -1)" ${idx === 0 ? 'disabled' : ''}>â–²</button>
            <button class="move-btn" onclick="moveItem(${idx}, 1)" ${idx === priorityOrder.length - 1 ? 'disabled' : ''}>â–¼</button>
          </div>
        </div>`
      ).join('');

      initQ10DragAndDrop();
      updateProgress();
    }

    // Q10: ä¸Šä¸‹ãƒœã‚¿ãƒ³ã§ç§»å‹•
    function moveItem(index, direction) {
      const newIndex = index + direction;
      if (newIndex < 0 || newIndex >= priorityOrder.length) return;
      const temp = priorityOrder[index];
      priorityOrder[index] = priorityOrder[newIndex];
      priorityOrder[newIndex] = temp;
      renderQ10();
    }

    // Q10: ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ï¼ˆPC + ã‚¿ãƒƒãƒï¼‰
    function initQ10DragAndDrop() {
      const list = document.getElementById('q10PriorityList');
      let dragIdx = null;

      list.querySelectorAll('.priority-item').forEach(item => {
        // PC: HTML5 Drag API
        item.addEventListener('dragstart', (e) => {
          dragIdx = parseInt(item.dataset.index);
          item.classList.add('dragging');
          e.dataTransfer.effectAllowed = 'move';
        });
        item.addEventListener('dragend', () => {
          item.classList.remove('dragging');
          dragIdx = null;
        });
        item.addEventListener('dragover', (e) => {
          e.preventDefault();
          e.dataTransfer.dropEffect = 'move';
        });
        item.addEventListener('drop', (e) => {
          e.preventDefault();
          const targetIdx = parseInt(item.dataset.index);
          if (dragIdx !== null && dragIdx !== targetIdx) {
            const moved = priorityOrder.splice(dragIdx, 1)[0];
            priorityOrder.splice(targetIdx, 0, moved);
            renderQ10();
          }
        });

        // ã‚¿ãƒƒãƒ: touch events
        let touchStartY = 0;
        let touchCurrentItem = null;
        let touchClone = null;

        item.addEventListener('touchstart', (e) => {
          const handle = e.target.closest('.handle');
          if (!handle) return; // ãƒãƒ³ãƒ‰ãƒ«ä»¥å¤–ã¯ã‚¹ãƒ«ãƒ¼
          e.preventDefault();
          dragIdx = parseInt(item.dataset.index);
          touchStartY = e.touches[0].clientY;
          item.classList.add('dragging');

          // ã‚´ãƒ¼ã‚¹ãƒˆè¦ç´ 
          touchClone = item.cloneNode(true);
          touchClone.style.position = 'fixed';
          touchClone.style.width = item.offsetWidth + 'px';
          touchClone.style.opacity = '0.8';
          touchClone.style.zIndex = '9999';
          touchClone.style.pointerEvents = 'none';
          touchClone.style.left = item.getBoundingClientRect().left + 'px';
          touchClone.style.top = e.touches[0].clientY - item.offsetHeight / 2 + 'px';
          document.body.appendChild(touchClone);
        }, { passive: false });

        item.addEventListener('touchmove', (e) => {
          if (dragIdx === null) return;
          e.preventDefault();
          const y = e.touches[0].clientY;
          if (touchClone) {
            touchClone.style.top = y - item.offsetHeight / 2 + 'px';
          }

          // ä»–ã®ã‚¢ã‚¤ãƒ†ãƒ ã¨ã®äº¤å·®åˆ¤å®š
          list.querySelectorAll('.priority-item').forEach(other => {
            if (other === item) return;
            const rect = other.getBoundingClientRect();
            const midY = rect.top + rect.height / 2;
            if (y > rect.top && y < rect.bottom) {
              const targetIdx = parseInt(other.dataset.index);
              if (targetIdx !== dragIdx) {
                const moved = priorityOrder.splice(dragIdx, 1)[0];
                priorityOrder.splice(targetIdx, 0, moved);
                dragIdx = targetIdx;
                renderQ10();
                // æ–°ã—ã„è¦ç´ ã«å†ã‚¢ã‚¿ãƒƒãƒã¯ renderQ10 ã§è¡Œã‚ã‚Œã‚‹
              }
            }
          });
        }, { passive: false });

        item.addEventListener('touchend', () => {
          if (touchClone) {
            touchClone.remove();
            touchClone = null;
          }
          item.classList.remove('dragging');
          dragIdx = null;
        });
      });
    }

    // é€²æ—æ›´æ–°
    function updateProgress() {
      const textFields = ['q1', 'q2', 'q3', 'q4-1', 'q4-2', 'q4-3', 'q4-4', 'q4-5', 'q6-1', 'q6-2', 'q7-1', 'summary'];
      let filled = 0;
      textFields.forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value.trim()) filled++;
      });
      if (selectedValues.length > 0) filled++;
      // Q9: ã‚¸ãƒ£ãƒ³ãƒ«ãŒ1ã¤ä»¥ä¸Šã‚ã‚Œã°
      if (Object.keys(genreData).length > 0) filled++;
      // Q10: å„ªå…ˆé †ä½ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°
      if (priorityOrder.length > 0) filled++;

      const total = textFields.length + 3; // +3 = Q8é¸æŠ, Q9ã‚¸ãƒ£ãƒ³ãƒ«, Q10å„ªå…ˆé †ä½
      const progress = (filled / total) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
    }

    // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
    async function saveData() {
      const data = {
        q1: document.getElementById('q1').value,
        q2: document.getElementById('q2').value,
        q3: document.getElementById('q3').value,
        q4: {
          kindergarten: document.getElementById('q4-1').value,
          elementary: document.getElementById('q4-2').value,
          junior: document.getElementById('q4-3').value,
          high: document.getElementById('q4-4').value,
          university: document.getElementById('q4-5').value
        },
        q6: {
          person: document.getElementById('q6-1').value,
          reason: document.getElementById('q6-2').value
        },
        q7: [
          document.getElementById('q7-1').value,
          document.getElementById('q7-2').value,
          document.getElementById('q7-3').value,
          document.getElementById('q7-4').value,
          document.getElementById('q7-5').value
        ],
        q8: {
          selected: selectedValues,
          other: document.getElementById('q8-other').value
        },
        q9: genreData,
        q10: priorityOrder,
        summary: document.getElementById('summary').value,
        timestamp: new Date().toISOString()
      };

      localStorage.setItem('selfUnderstanding_values', JSON.stringify(data));
// Lark BaseåŒæœŸ      if (window.DataSync) {        try {          await window.DataSync.saveWorkData('values', data);        } catch (e) {          console.error('Lark sync failed:', e);        }      }
      showToast('ä¿å­˜ã—ã¾ã—ãŸï¼', 'success');
    }

    // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
    function loadData() {
      const saved = localStorage.getItem('selfUnderstanding_values');
      if (saved) {
        const data = JSON.parse(saved);

        document.getElementById('q1').value = data.q1 || '';
        document.getElementById('q2').value = data.q2 || '';
        document.getElementById('q3').value = data.q3 || '';

        if (data.q4) {
          document.getElementById('q4-1').value = data.q4.kindergarten || '';
          document.getElementById('q4-2').value = data.q4.elementary || '';
          document.getElementById('q4-3').value = data.q4.junior || '';
          document.getElementById('q4-4').value = data.q4.high || '';
          document.getElementById('q4-5').value = data.q4.university || '';
        }

        if (data.q6) {
          document.getElementById('q6-1').value = data.q6.person || '';
          document.getElementById('q6-2').value = data.q6.reason || '';
        }

        if (data.q7) {
          data.q7.forEach((v, i) => {
            const el = document.getElementById(`q7-${i+1}`);
            if (el) el.value = v || '';
          });
        }

        if (data.q8) {
          selectedValues = data.q8.selected || [];
          document.getElementById('q8-other').value = data.q8.other || '';
          // é¸æŠçŠ¶æ…‹ã‚’å¾©å…ƒ
          selectedValues.forEach(value => {
            document.querySelectorAll('.value-tag').forEach(tag => {
              if (tag.textContent === value) tag.classList.add('selected');
            });
          });
          updateSelectedDisplay();
        }

        // Q9: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼ or æ—§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæ–‡å­—åˆ—ï¼‰
        if (data.q9 && typeof data.q9 === 'object' && !Array.isArray(data.q9)) {
          genreData = data.q9;
        } else {
          genreData = {};
        }

        // Q10: é…åˆ—å½¢å¼ or æ—§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæ–‡å­—åˆ—ï¼‰
        if (Array.isArray(data.q10)) {
          priorityOrder = data.q10;
        } else {
          priorityOrder = [];
        }

        document.getElementById('summary').value = data.summary || '';

        renderQ9();
        renderQ10();
        updateProgress();
      }
    }

    // ãƒˆãƒ¼ã‚¹ãƒˆ
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = 'toast ' + type + ' show';
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆã§é€²æ—æ›´æ–°
    document.querySelectorAll('textarea, input').forEach(el => {
      el.addEventListener('input', updateProgress);
    });

    // åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', () => {
      renderValueTags();
      loadData();
    });
  </script>
</body>
</html>
